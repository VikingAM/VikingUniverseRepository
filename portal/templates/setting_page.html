{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Edit Profile</title>
	<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">
	<link rel="stylesheet" href="{% static 'portal/css/style.css' %}">
	<link rel='stylesheet' id='icos-fonts-css' href='https://fonts.googleapis.com/css?family=Nunito%3A300%2C300i%2C400%2C400i%2C600%2C600i%2C700%2C700i%2C800%2C800i%2C900%2C900i%7CPoppins%3A100%2C100i%2C200%2C200i%2C300%2C300i%2C400%2C400i%2C500%2C500i%2C600%2C600i%2C700%2C700i%2C800%2C800i%2C900%2C900i%7CRoboto%3A300%2C400%2C600&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
	<style type="text/css">
		.form-group label{
			font-size: 15px;
		}
		.form-group input{
			font-size: 12px;
		}
		.form-group select{
			font-size: 12px;
		}
		.form-group{
			margin: 0px 0px 7px;
		}

		.profile_save_btn{
			position: absolute;
			background: linear-gradient(90.97deg, rgba(26, 47, 238, 0.85) 0%, rgba(196, 26, 238, 0.85) 99.67%);
			border-radius: 13px;
			width: 80%;
		}

		.password_save_btn{
			position: absolute;
			background: linear-gradient(90.97deg, rgba(26, 47, 238, 0.85) 0%, rgba(196, 26, 238, 0.85) 99.67%);
			border-radius: 13px;
			width: 80%;
		}
		.profile_cancel_btn{
			position: absolute;
			border-radius: 13px;
			width: 80%;
		}

		.wrapper-2{
			display: block;
    		z-index: 5;
    		position: relative;
		}

		.current_password {
			border: 1px solid #9A9797;
			border-radius: 13px;
			
		}
		.password_setting_label{
			font-family: 'Poppins';
			font-weight: 700;
		}
		.setting_sidebar-2_header{
			font-family: 'Poppins';
			font-weight: 700;
			color: #21055B;
			font-size: 20px;
			margin-left: 20%;
			padding-bottom: 5%;
		}

		.sidebar-2_active{
			color: #311B92;
		}

		.sidebar-2_nonactive{
			color: #585858;
		}
	</style>
</head>
<body style="background-color: #F5F6FA;">

<div class="wrapper d-flex">
	{% include 'sidebar.html' %}
</div>
<div class="container" >
	<div class="row">
		<div class="col-sm-2">
			<div class="wrapper-2 d-flex">
				<div class="sidebar-2">
					<span class="setting_sidebar-2_header">Settings</span>
					<ul style="margin-top: 40%;">
					<li><a href="#profile_setting" id="profile_setting" onclick="chooseSidebar2(this);" wrapper="profile_edit_wrapper" class="sidebar-2_active"><i class="far fa-edit"></i>Profile</a></li>
					<li><a href="#profile_password" id="profile_password" onclick="chooseSidebar2(this);" wrapper="password_change_wrapper" class="sidebar-2_nonactive"><i class="fas fa-users"></i>Password</a></li>
					<li><a href="#" id="profile_invoice" onclick="chooseSidebar2(this);" wrapper="" class="sidebar-2_nonactive"><i class="fas fa-users" ></i>Invoices</a></li>
					<li><a href="#profile_manager" id="profile_manager" onclick="chooseSidebar2(this);" wrapper="" class="sidebar-2_nonactive" ><i class="fas fa-users"></i>Password Manager</a></li>
					<li><a href="#" id="profile_faqs" onclick="chooseSidebar2(this);" wrapper="" class="sidebar-2_nonactive"><i class="fas fa-users"></i>FAQS</a></li>
					</ul>
				</div>
			</div>
		</div>	
	</div>
	<div id="profile_edit_wrapper" >
		{% include 'profile_edit.html' %}
	</div>
	<div id="password_change_wrapper" style="display:none;">
		{% include 'reset_password_form.html' %}
	</div>

</div>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" type="text/javascript"></script>
<script type="text/javascript">
	$(document).ready(function(){
		page_current_open()
	})

	function page_current_open(){
		var url = $(location). attr("href");
		var urlsplit = url.split("#")
		var side_bar2_array = ["profile_setting", "profile_password", "profile_manager", "profile_invoice", "profile_faqs"];
		if (urlsplit.length > 1){
			$.each(side_bar2_array, function(index, value){
				var wrapper = $("#"+value).attr("wrapper");
				if( urlsplit[1] == value){
					$("#"+wrapper).show();
					$("#"+value).addClass("sidebar-2_active").removeClass("sidebar-2_nonactive");
				}else{
					$("#"+wrapper).hide();
					if($("#"+value).attr("class") == "sidebar-2_nonactive"){
					}else{
						$("#"+value).addClass("sidebar-2_nonactive").removeClass("sidebar-2_active");
					}
				}
			})
		}
	}

	function chooseSidebar2(that){
		var side_bar2_array = ["profile_setting", "profile_password", "profile_manager", "profile_invoice", "profile_faqs"];
		$.each(side_bar2_array, function(index, value){
			var wrapper = $("#"+value).attr("wrapper");
			if( $(that).attr("id") == value){
				$("#"+wrapper).show();
				$("#"+value).addClass("sidebar-2_active").removeClass("sidebar-2_nonactive");
			}else{
				$("#"+wrapper).hide();
				if($("#"+value).attr("class") == "sidebar-2_nonactive"){
				}else{
					$("#"+value).addClass("sidebar-2_nonactive").removeClass("sidebar-2_active");
				}
			}
		})
	}


	function password_change_save_btn(){
		var sent_otp = $("#sent_otp").val();
		var otp = $("#OTP").val();
		otp_warning_label.empty();
		if(sent_otp.length != 0){
			// change soon to check if we already send an otp
			if (otp.length = 6){
				
			}else{
				otp_warning_label.append("Invalid otp!")
				return false;
			}
			// for now check if the otp field is not empty!
			// check if the otp len is == 6
			// send ajax.
		}else{
			//send otp on email
			// $.ajax({
		    //     type: "POST",
		    //     url: "{% url 'passwordResetOtp' %}",
		    //     data: {
		    //     		"csrfmiddlewaretoken": '{{ csrf_token }}',
		    //     		"userId": '{{ request.user.id }}'
		    // 		},
		    //     async:true,
		    //     success: function (data) {
		    //         alert("success");
		    //         $("#sent_otp").val(1);
		    //     },
		    //     error: function (e) {
		    //         alert("Error! please try again later.");
		    //     }
		    // })
		}
	}

	function validatePassword() {
	    var p = document.getElementById('newPassword').value,
	        errors = [];
	    if (p.length < 8) {
	        errors.push("Your password must be at least 8 characters"); 
	    }
	    if (p.search(/[a-z]/i) < 0) {
	        errors.push("Your password must contain at least one letter.");
	    }
	    if (p.search(/[0-9]/) < 0) {
	        errors.push("Your password must contain at least one digit."); 
	    }
	    if (errors.length > 0) {
	        alert(errors.join("\n"));
	        return false;
	    }
	    return true;
	}
</script>
</body>
</html>