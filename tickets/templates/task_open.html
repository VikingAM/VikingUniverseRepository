{% load static %}
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Task Dashboard</title>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@1,700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="{% static 'portal/css/navbar.css' %}">
	<link rel="stylesheet" href="{% static 'fontawesome/css/all.css' %}">
	<style type="text/css">
		.title_name{
			font-family: 'Poppins', sans-serif;
			font-style: normal;
			font-weight: 600;
			font-size: 60px;
			line-height: 90px;
			color: #6417A1;
		}

		.edit_task_name{
			font-family: 'Poppins', sans-serif;
			font-style: normal;
			font-weight: 600;
			font-size: 45px;
			line-height: 90px;
			color: #6417A1;
		}

		.description_title{
			font-family: 'Poppins', sans-serif;
			font-style: normal;
			font-weight: 600;
			font-size: 25px;
			line-height: 38px;
			color: #0717A3;
		}
		.task_description p {
			font-family: 'Poppins', sans-serif;
			font-style: normal;
			font-weight: 600;
			font-size: 25px;
			line-height: 38px;
			color: #0717A3;
		}
		.credit_used{
			font-family: 'Poppins', sans-serif;
			font-style: normal;
			font-weight: 700;
			font-size: 20px;
			line-height: 30px;
			color: #000000;
		}
		.edit_task_btn{
			background: linear-gradient(90.97deg, rgba(26, 47, 238, 0.85) 0%, rgba(196, 26, 238, 0.85) 99.67%);
			border-radius: 10px;
			font-family: 'Poppins', sans-serif;
			font-style: normal;
			font-weight: 600;
			font-size: 20px;
			line-height: 30px;
			color: #FFFFFF;
			width: 100%;
    		border: 0px;
    		padding: 3% 0%;
		}
		.delete_task_btn{
			background: #FFFFFF;
			border-radius: 10px;
			font-family: 'Poppins', sans-serif;
			font-style: normal;
			font-weight: 600;
			font-size: 20px;
			line-height: 30px;
			color: #000000;
			width: 99%;
    		padding: 3% 0%;
		}
		.edit_form_name{
			font-family: 'Lato', sans-serif;
			font-style: normal;
			font-weight: 700;
			font-size: 20px;
			line-height: 24px;
			color: #3E1774;
		}
	</style>
</head>
<body style="background:#F5F6FA;">
<div class="row" id="body-row">
	{% include 'sidebar_v1.html' %}
	<div class="col p-4 main-container">
		<div class="row search_bar_wrapper">
			<div class="col-sm-10">
				<!-- <input class="form-control" type="text" id="portal_search_bar" name="portal_search_bar" placeholder="Search . . . "> -->
			</div>
			<div class="col-sm-2" style="text-align:right; margin: auto;">
				<i class="fas fa-fw fa-bell"></i> <span class="indicator"></span>
				<span>
					<img src="https://img.icons8.com/dusk/100/000000/user-female-circle.png" alt="" class="user-avatar-md rounded-circle" width="25px">
					{{ profile_details.first_name }} {{ profile_details.last_name }}
					<span class="dropdown">
						<span class="fa-solid fa-angle-down" type="button" id="Account-menu" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"></span>
						<div class="dropdown-menu dropdown-menu-right" aria-labelledby="Account-menu">
							<button class="dropdown-item" type="button">Account</button>
						    <button class="dropdown-item" type="button">Settings</button>
						    <button class="dropdown-item" type="button">Logout</button>
						</div>
					</span>
				</span>
			</div>
		</div><br/>
		<br/><br/>
		<!-- main container -->
		<div class="row" style="background: #FFFFFF;">
			<div class="col-sm-1"></div>
			<div class="col-sm-10">
				<div class="row">
					<div class="col-sm-8">
						<span class="title_name">
							{{ task_detail.title }}
						</span>
					</div>
					<div class="col-sm-4">
						<br/><br/>
						<div class="progress" style=" height: 1.5rem;">
							<div class="progress-bar" role="progressbar" style="width: 0%; font-size: 20px; text-align: center; background: #BEA4EC;" aria-valuenow="25" aria-valuemin="{{ task_detail.task_percentage}}" aria-valuemax="100">{{ task_detail.task_percentage}}%</div>
						</div>
					</div>
				</div>
				<div class="row">
					<div class="col-sm-12">
						<span class="description_title">
							Description
						</span>
					</div><br/>
					<div class="col-sm-12" class="task_description">
						<p>{{ task_detail.description }}</p>
					</div>
					<br/><br/>
				</div>
				<div class="row">
					<div class="col-sm-2">
						<div class="card">
							<div class="card-body">
						    	<div class="row">
						    		<div class="col-sm-8">
						    			Start Date<br/>
						    			{{ task_detail.create_date |date:"M d, Y" }}
						    		</div>
						    		<div class="col-sm-4">
						    			<i class="fa-solid fa-clock" style="font-size: 45px; color: #562E91;"></i>
						    		</div>
						    	</div>
						  	</div>
						</div>
					</div>
					<div class="col-sm-2">
						<div class="card">
  							<div class="card-body">
    							<div class="row">
						    		<div class="col-sm-8">
						    			Attachments<br/>
						    			0
						    		</div>
						    		<div class="col-sm-4">
						    			<i class="fa-solid fa-file-lines" style="font-size: 45px; color: #2A3A8F;"></i>
						    		</div>
						    	</div>
  							</div>
						</div>
					</div>
				</div>
				<br/><br/>
				<div class="row">
					<div class="col-sm-12" >
						<span class="description_title">Details</span>	
					</div><br/><br/>
					<div class="col-sm-12">
						<span class="credit_used">Credits used for this task:</span>
					</div>
				</div>
				<br/><br/>
				<div class="row">
					<div class="col-sm-12" >
						<span class="description_title">Status</span>	
					</div><br/><br/>
					<div class="col-sm-12">
						<span class="task_description">The Task Was Submitted and waiting to be assigned on one of our agents.</span>
					</div>
				</div>
				<br/><br/><br/>
				<div class="row">
					<div class="col-sm-4"></div>
					<div class="col-sm-2">
						<button class="edit_task_btn" onclick="EditTaskBtn();">Edit Task</button>
					</div>
					<div class="col-sm-2">
						<button class="delete_task_btn">Delete</button>
					</div>
					<div class="col-sm-4"></div>
				</div>
				<br/><br/><br/>
			</div>
			<div class="col-sm-1"></div>
		</div>
	</div>

	<div class="modal fade" id="EditTaskForm" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  		<div class="modal-dialog modal-lg">
    		<div class="modal-content">
      			<div class="modal-body">
      				<div class="row">
      					<div class="col-sm-12 edit_task_name" style="text-align:center;">Edit Task</div>
      				</div>
      				<div class="row">
      					<div class="col-sm-12">
      						<div class="alert alert-success edit_task_success" role="alert" style="display:none;">
  								Update Successful! Reloading page . . .
							</div>
							<div class="alert alert-warning edit_task_error" role="alert" style="display:none; cursor: pointer;" onclick="closeThis(this);">
  								
							</div>
      					</div>
      				</div>
      				<div class="row">
      					<div class="col-sm-2"></div>
      					<div class="col-sm-4 edit_form_name">
      						Task Name
      					</div>
      					<div class="col-sm-6 ">
      						<input class="form-control" type="text" name="task_title" id="task_title" value="{{ task_detail.title }}">
      						<input type="hidden" id="edit_task_id" name="edit_task_id" value="{{  task_detail.pk }}">
      					</div>
      				</div>
      				<hr>
      				<div class="row">
      					<div class="col-sm-2"></div>
      					<div class="col-sm-4 edit_form_name">
      						Description
      					</div>
      					<div class="col-sm-6 ">
      						<textarea class="form-control" name="edit_description" id="edit_description" rows="5">{{ task_detail.description }}</textarea>
      					</div>
      				</div>
      				<hr>
      				<div class="row">
      					<div class="col-sm-2"></div>
      					<div class="col-sm-4 edit_form_name">
      						Attachments
      					</div>
      					<div class="col-sm-6 ">
      						
      					</div>
      				</div>
      				<hr>
      				<div class="row">
      					<div class="col-sm-2"></div>
      					<div class="col-sm-4 edit_form_name">
      						Edit Task Forms
      					</div>
      					<div class="col-sm-6 ">
      						
      					</div>
      				</div>
      				<br/><br/>
      				<div class="row">
      					<div class="col-sm-3"></div>
      					<div class="col-sm-3">
      						<button class="edit_task_btn" onclick="SubmitEditTask();">Submit</button>
      					</div>
      					<div class="col-sm-3">
      						<button class="delete_task_btn"  data-dismiss="modal">Close</button>
      					</div>
      					<div class="col-sm-3"></div>
      				</div>
      			</div>
    		</div>
  		</div>
	</div>
</div>
<script src="//code.jquery.com/jquery-1.11.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
<!-- <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script> -->
<script src="{% static 'portal/js/portalnavbar.js' %}"></script>
<script>
	$(document).ready(function(){
		
	})

	function closeThis(that){
		$(that).hide();
	}
	function EditTaskBtn(){
		$("#EditTaskForm").modal("show");
	}
	function SubmitEditTask(){
		$(".edit_task_error").hide();
		var edit_task_title = $("#task_title").val();
		if(edit_task_title.length == 0){
			$(".edit_task_error").show();
    		$(".edit_task_error").empty();
    		$(".edit_task_error").append("Task title should not be empty!");
			return false;
		}
		var edit_task_description = $("#edit_description").val();
		if(edit_task_description.length == 0){
			$(".edit_task_error").show();
    		$(".edit_task_error").empty();
    		$(".edit_task_error").append("Task description should not be empty!");
			return false;
		}
		var edit_task_id = $("#edit_task_id").val();
		$.ajax({
	        type: "POST",
	        url: "{% url 'editTask' %}",
	        data: {
	        	"csrfmiddlewaretoken": '{{ csrf_token }}',
	        	"task_title":edit_task_title,
	        	"description":edit_task_description,
	        	"task_id":edit_task_id,
	        },
	        async:true,
	        success: function (data) {
	        	if(data.status_code == 1){
	        		$(".edit_task_success").show();
	        		location.reload(true);
	        	}else{
	        		$(".edit_task_error").show();
	        		$(".edit_task_error").empty();
	        		$(".edit_task_error").append(data.error_msg)
	        	}
	        	
	        },
	        error: function (e) {
	            // $("#new_password_error").append("Error! please try again later.");
	        }
	    })
	}
	
</script>
</body>
</html>