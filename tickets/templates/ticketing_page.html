{% load static %}
<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Portal Dashboard</title>
	<link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/releases/v5.7.2/css/all.css">
	<link rel="stylesheet" href="{% static 'portal/css/style.css' %}">
	<link rel='stylesheet' id='icos-fonts-css' href='https://fonts.googleapis.com/css?family=Nunito%3A300%2C300i%2C400%2C400i%2C600%2C600i%2C700%2C700i%2C800%2C800i%2C900%2C900i%7CPoppins%3A100%2C100i%2C200%2C200i%2C300%2C300i%2C400%2C400i%2C500%2C500i%2C600%2C600i%2C700%2C700i%2C800%2C800i%2C900%2C900i%7CRoboto%3A300%2C400%2C600&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
	<link rel="stylesheet" type="text/css" href="//cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
	<style type="text/css">
		.submit_issue_ticket_header_text{
			font-family: 'Poppins';
			font-style: normal;
			font-weight: 700;
			font-size: 35px;
			line-height: 60px;
			color: #6417A1;
		}

		.ticket_list_header_text{
			font-family: 'Poppins';
			font-style: normal;
			font-weight: 700;
			font-size: 25px;
			line-height: 60px;
			color: #6417A1;
		}

		.small_text{
			font-family: 'Poppins';
			font-style: normal;
			font-weight: 500;
			font-size: 16px;
			line-height: 30px;
			color: #A0A0A0;
		}
		.submit_ticket_label_input{
			font-family: 'Poppins';
			font-style: normal;
			font-weight: 600;
			font-size: 15px;
			line-height: 30px;
			color: #000000;
		}

		.ticket_form_input{
			background: #FFFFFF;
			border: 1px solid #BDBDBD;
			border-radius: 10px;
		}

		.ticket_form_input_textarea{
			background: #FFFFFF;
			border: 1px solid #BDBDBD;
			border-radius: 10px;
			height: 200px;
		}
		.submit_ticket_btn{
			background: linear-gradient(90.97deg, rgba(26, 47, 238, 0.85) 0%, rgba(196, 26, 238, 0.85) 99.67%);
			border-radius: 10px;
			color: #FFFFFF;
		}
		.all_ticket_list_wrapper{
			background: #FFFFFF;
			border: 1px solid #BFBFBF;
			border-radius: 13px;
			min-height: 100%;
		}

		.filter_btn{
			font-family: 'Poppins';
			font-style: normal;
			font-weight: 500;
			font-size: 15px;
			line-height: 22px;
			color: #FFFFFF;
			background: linear-gradient(90.97deg, rgba(26, 47, 238, 0.85) 0%, rgba(196, 26, 238, 0.85) 99.67%);
			border: 1px solid #D8D8D8;
			border-radius: 8px;
		}
		.right{
			float: right;
			text-align: right;
		}
		.left{
			float:left;
			text-align: left;
		}

		.ticket_list_header{
			font-family: 'Poppins';
			font-style: normal;
			font-weight: 700;
			font-size: 20px;
			line-height: 30px;
			color: #0717A3;
		}

		.ticket_list_created_time{
			font-family: 'Poppins';
			font-style: normal;
			font-weight: 700;
			font-size: 15px;
			line-height: 22px;
			color: #1B1971;
		}
		.ticket_description{
			font-family: 'Poppins';
			font-style: normal;
			font-weight: 400;
			font-size: 15px;
			line-height: 22px;
			color: #000000;
		}
		.ticket_list_id{
			background: #FFFFFF;
			border: 1px solid #D9D9D9;
			border-radius: 8px;
			font-family: 'Lato';
			font-style: normal;
			font-weight: 700;
			font-size: 10px;
			line-height: 12px;
			color: #272727;
			margin-top: 10px;
			margin-left: 10px;
		}
		#ticket_list_wrapper{
			width: 100%;
		}

		#ticket_list{
			border-collapse: separate;
  			border-spacing: 0 15px;
		}
	</style>
</head>
<body style="background:#F5F6FA;">
<div class="wrapper d-flex" style="z-index: 4;">
	{% include 'sidebar.html' %}
</div>
<div class="row">
	
</div><br/><br/>
<div class="container-fluid" style="z-index: 4;">
	<div class="row">
	<div class="col-sm-2"></div>
	<div class="col-sm-10">
		<div class="row">
			<div class="col-sm-5">
				<div class="row">
					<div class="col-sm-12">	
						<span class="submit_issue_ticket_header_text">Submit Issue Ticket</span>
					</div>
				</div>
				<div class="row">
					<div class="col-sm-12">
						<p class="small_text">Please provide the details of the problem</p>
					</div>
				</div>
				<div class="row">
					<div class="col-sm-12">
						<span class="submit_ticket_label_input">Ticket Type</span>
					</div>
					<div class="col-sm-12">
						<select class="form-control ticket_form_input" name="ticket_type" id="ticket_type">
							<option value="0">-- Select Ticket Type --</option>
							{% for type in issue_types %}
								<option value="{{ type.pk }}">{{ type.name }}</option>
							{% endfor %}
						</select>
					</div>
				</div>
				<br/>
				<div class="row">
					<div class="col-sm-12">
						<span class="submit_ticket_label_input">Ticket Title</span>
					</div>
					<div class="col-sm-12">
						<input type="text" name="ticket_title" id="ticket_title" value="" class="form-control ticket_form_input">
					</div>
				</div>
				<br/>
				<div class="row">
					<div class="col-sm-12">
						<span class="submit_ticket_label_input">Description</span>
					</div>
					<div class="col-sm-12">
						<textarea  class="ticket_form_input_textarea form-control" rows="7" name="ticket_description" id="ticket_description"></textarea>
					</div>
				</div>
				<br/><br/>
				<div class="row">
					<div class="col-sm-3"></div>
					<div class="col-sm-6">
						<button class="submit_ticket_btn form-control" onclick="SubmitNewTicket();">
							Submit Ticket
						</button>
					</div>
					<div class="col-sm-3"></div>
				</div>
			</div>
			<div class="col-sm-7">
				<div class="col-sm-12 all_ticket_list_wrapper">
					<div class="row">
						<div class="col-sm-7">	
							<span class="ticket_list_header_text">All Tickets</span>
						</div>
						<div class="col-sm-5">
							<div class="input-group mb-3" style="margin-top:5%;">
			  					<input type="text" class="form-control" placeholder="Search Ticket" aria-label="Recipient's username" aria-describedby="basic-addon2">
			  					<div class="input-group-append">
			    					<button class="filter_btn btn btn-outline-secondary" type="button">Filter
			    						<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-filter" viewBox="0 0 16 16">
  											<path d="M6 10.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5z"/>
										</svg>
									</button>
			  					</div>
							</div>
						</div>
					</div>
					<div class="list_of_ticket_wrapper">
						<div class="row">
							<table class="table" id="ticket_list" style="width: 95%; margin: auto;">
								<thead>
									<tr>
										<th>Tickets</th>
									</tr>
								</thead>
								<tbody>
									{% for ticket in issue_tickets %}
									<tr>
										<td style="border: 1px solid #BDBDBD; border-radius: 10px; margin-top: 5px;">
											<div class="row">
												<div class="col-sm-12"><span class="left ticket_list_header">Cannot pay my plan</span> <span class="right ticket_list_created_time">{{ ticket.create_date | timesince }} ago</span> </div>
											</div>	
											<div class="row">
												<div class="col-sm-12 ticket_description">
													Amet minim mollit non deserunt ullamco est sit aliqua dolor do amet sint. Velit officia consequat duis enim velit mollit. Exercitation veniam consequat sunt nostrud amet.
												</div>
											</div>
											<div class="row">
												<div class="col-sm-12">
													<span class="left ticket_list_id">
														#{{ ticket.id }}
													</span>
												</div>
											</div>
										</td>
									</tr>
									{% empty %}
									<tr>
										<td style="border: 1px solid #BDBDBD; border-radius: 10px;">
											<div class="row">
												<div class="col-sm-12" style="width:100%;">
													<span class="left ticket_list_header">To Ticket Posted</span>
												</div>
											</div>	
										</td>
									</tr>
									{% endfor %}
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
			
			<!-- <div class="col-sm-7" >
				<div class="col-sm-12 all_ticket_list_wrapper">
					<div class="row">
						<div class="col-sm-7">	
							<span class="ticket_list_header_text">All Tickets</span>
						</div>
						<div class="col-sm-3">
							<input class="search_ticket_input form-control" type="text" name="" placeholder="search ticket">
						</div>
						<div class="col-sm-2">
							<button class="filter_btn form-control">filter
								<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-filter" viewBox="0 0 16 16">
  									<path d="M6 10.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 0 1h-3a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h7a.5.5 0 0 1 0 1h-7a.5.5 0 0 1-.5-.5zm-2-3a.5.5 0 0 1 .5-.5h11a.5.5 0 0 1 0 1h-11a.5.5 0 0 1-.5-.5z"/>
								</svg>
							</button>
						</div>
					</div>
				</div>
			</div> -->
		</div>
	</div>
</div>
</div>

<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js" type="text/javascript"></script>
<script src="//cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
<script type="text/javascript">
	$(document).ready(function(){
		$("#ticket_list").DataTable();
		$("#ticket_list_length").hide();
		$("#ticket_list_filter").hide();
	})

	function SubmitNewTicket(){
		var ticket_type = $("#ticket_type").val();
		var ticket_title = $("#ticket_title").val();
		var ticket_description = $("#ticket_description").val();
		$.ajax({
	        type: "POST",
	        url: "{% url 'Addticket' %}",
	        data: {
	        	"csrfmiddlewaretoken": '{{ csrf_token }}',
	        	"type":ticket_type,
	        	"title": ticket_title,
	        	"description": ticket_description,
	        },
	        async:true,
	        success: function (data) {

	        },
	        error: function (e) {
	            // $("#new_password_error").append("Error! please try again later.");
	        }
	    })

	}
</script>
</body>
</html>